<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>公約数を見つけよう！（縦固定）</title>
<style>
  :root{
    --chip: clamp(44px, 9vw, 80px);        /* タイルの最小一辺 */
    --gap: clamp(6px, 1.8vw, 14px);        /* グリッド間隔 */
    --pad: clamp(10px, 2.4vw, 20px);       /* 全体のパディング */
    --radius: 18px;
    --shadow: 0 8px 22px rgba(0,0,0,.06);

    --bg:#f7f8fb; --ink:#111827; --muted:#6b7280; --card:#ffffff; --border:#e5e7eb;
    --accent:#2563eb;

    --hit:#10b981;           /* 公約数（緑） */
    --hit-border:#065f46;

    --divA-bg:#fff7cc;       /* 数１の約数（薄い黄色） */
    --divA-bd:#f2cf4a;
    --divB-bg:#ffe4ec;       /* 数２の約数（薄いピンク） */
    --divB-bd:#f3a9bf;
  }
  *{box-sizing:border-box; -webkit-tap-highlight-color: transparent;}
  html,body{height:100%}
  body{
    margin:0; font-family:"Inter","BIZ UDPGothic","Hiragino Kaku Gothic ProN",system-ui,sans-serif;
    background:var(--bg); color:var(--ink);
    padding: var(--pad);
  }
  .wrap{max-width:1000px; margin:0 auto}
  .card{
    background:var(--card); border:1px solid var(--border);
    border-radius:var(--radius); box-shadow:var(--shadow);
    padding: var(--pad);
  }
  h1{font-size:clamp(20px, 4.8vw, 32px); margin:.2em 0 .6em}

  .row{display:flex; gap:12px; flex-wrap:wrap; align-items:center}
  .grow{flex:1}
  .picker{
    display:flex; align-items:center; gap:8px;
    background:#fff; border:1px solid var(--border); border-radius:14px; padding:8px;
    min-width:min(100%, 520px);
  }
  .picker label{font-weight:700; color:#111; min-width:3em; font-size:clamp(14px,2.8vw,18px)}
  .nbox{
    display:flex; align-items:center; gap:8px;
    background:#f9fafb; border:1px solid var(--border); border-radius:12px; padding:6px;
    margin-left:auto;
  }
  .nbox input{
    width: clamp(88px, 18vw, 120px);
    font-size: clamp(18px, 4.5vw, 22px);
    padding:10px 12px; border:1px solid var(--border); border-radius:10px;
    -moz-appearance: textfield;
  }
  .nbox input::-webkit-outer-spin-button,
  .nbox input::-webkit-inner-spin-button{ -webkit-appearance: none; margin: 0; }
  .nbox button{
    width: clamp(44px, 9vw, 56px); height: clamp(44px, 9vw, 56px);
    border-radius:12px; border:1px solid var(--border); background:#fff;
    font-size: clamp(18px, 5vw, 22px); cursor:pointer;
    display:grid; place-items:center;
  }
  .nbox button:active{transform:scale(.98)}

  /* 操作ボタン群（常に見える） */
  .actions{
    position: sticky; top: calc(env(safe-area-inset-top) + 6px);
    background:linear-gradient(#fff, #fff0);
    padding-top:6px; padding-bottom:6px;
    display:flex; gap:10px; flex-wrap:wrap; z-index:10;
  }
  .btn{
    appearance:none; border:none; cursor:pointer;
    background:var(--accent); color:#fff; font-weight:700;
    padding: clamp(12px, 2.6vw, 16px) clamp(14px, 3vw, 18px);
    border-radius:14px; font-size: clamp(16px, 3.8vw, 18px);
    min-height: clamp(44px, 9vw, 56px);
  }
  .btn.secondary{background:#fff; color:#111; border:1px solid var(--border)}
  .btn:active{transform:translateY(1px)}

  /* ★ 縦固定：常に上下に並べる（一列グリッド） */
  .panes{
    display:grid; gap: var(--gap);
    grid-template-columns: 1fr;  /* ← 一列に固定 */
  }

  .label{
    font-weight:700; color:#111; margin:14px 0 8px;
    display:flex; align-items:center; gap:8px; font-size: clamp(14px,3.2vw,16px);
  }
  .legend{display:flex; gap:10px; align-items:center; font-size:clamp(12px,3vw,14px); color:var(--muted)}
  .legend .box{width:14px; height:14px; border-radius:4px; border:1px solid var(--border)}
  .legend .y{background:var(--divA-bg); border-color:var(--divA-bd)}
  .legend .p{background:var(--divB-bg); border-color:var(--divB-bd)}
  .legend .g{background:#ecfdf5; border-color:var(--hit-border)}

  .grid{
    display:grid; gap: var(--gap);
    grid-template-columns: repeat(auto-fill, minmax(var(--chip), 1fr));
  }
  .chip{
    display:inline-flex; align-items:center; justify-content:center;
    min-width: var(--chip); min-height: var(--chip);
    background:#fff; border:2px solid #e5e7eb; border-radius:12px;
    font-size: clamp(18px, 4.6vw, 22px); user-select:none;
  }
  .chip.divA{ background: var(--divA-bg); border-color: var(--divA-bd); }
  .chip.divB{ background: var(--divB-bg); border-color: var(--divB-bd); }
  .chip.hit{
    background:#ecfdf5 !important; border-color: var(--hit-border) !important; color:#065f46;
    box-shadow: inset 0 0 0 3px var(--hit);
    text-decoration: underline; text-decoration-thickness: 3px;
  }

  .result{
    background:#f8fafc; border:1px dashed var(--border); border-radius:14px;
    padding:12px; margin-top:14px; color:#111; font-size: clamp(14px,3.4vw,16px);
  }
  .result b{display:inline-block; margin-right:6px}
  .empty{color:var(--muted)}
  .footer{color:var(--muted); font-size:clamp(12px,3vw,14px); margin-top:10px}
</style>
</head>
<body>
  <div class="wrap">
    <h1>公約数を見つけよう！</h1>

    <div class="card" role="group" aria-label="入力エリア">
      <!-- 入力 -->
      <div class="row" style="margin-bottom:10px">
        <div class="picker grow">
          <label for="a">数１</label>
          <div class="nbox">
            <button type="button" aria-label="数１を1へらす" onclick="step('a',-1)">−</button>
            <input id="a" type="number" min="1" value="2" inputmode="numeric" oninput="clamp('a'); render()">
            <button type="button" aria-label="数１を1ふやす" onclick="step('a',1)">＋</button>
          </div>
        </div>
        <div class="picker grow">
          <label for="b">数２</label>
          <div class="nbox">
            <button type="button" aria-label="数２を1へらす" onclick="step('b',-1)">−</button>
            <input id="b" type="number" min="1" value="3" inputmode="numeric" oninput="clamp('b'); render()">
            <button type="button" aria-label="数２を1ふやす" onclick="step('b',1)">＋</button>
          </div>
        </div>
      </div>

      <!-- 操作（常に見える） -->
      <div class="actions">
        <button class="btn" onclick="findCommon()">🟢 公約数を見つける</button>
        <button class="btn secondary" onclick="resetAll()">🔄 リセット</button>
      </div>

      <!-- ★ 表示パネル（縦固定：数１が上、数２が下） -->
      <div class="panes">
        <section>
          <div class="label">
            数１（1 〜 <span id="amax">12</span>）
            <span class="legend" aria-hidden="true">
              <span class="box y"></span>数１の約数
              <span class="box g"></span>公約数（緑の強調）
            </span>
          </div>
          <div id="gridA" class="grid" aria-live="polite"></div>
        </section>

        <section>
          <div class="label">
            数２（1 〜 <span id="bmax">18</span>）
            <span class="legend" aria-hidden="true">
              <span class="box p"></span>数２の約数
              <span class="box g"></span>公約数（緑の強調）
            </span>
          </div>
          <div id="gridB" class="grid" aria-live="polite"></div>
        </section>
      </div>

      <!-- 結果 -->
      <div class="result" id="resultBox" aria-live="polite">
        <div id="listLine" class="empty">公約数がここに表示されます。</div>
        <div id="gcdLine" class="empty">最大公約数：—</div>
      </div>

      <div class="footer">
        薄い色は各段の「約数」。ボタンを押すと「公約数」が緑になる。
      </div>
    </div>
  </div>

<script>
  const gridA = document.getElementById('gridA');
  const gridB = document.getElementById('gridB');
  const amax = document.getElementById('amax');
  const bmax = document.getElementById('bmax');
  const listLine = document.getElementById('listLine');
  const gcdLine = document.getElementById('gcdLine');

  function val(id){ return Math.max(1, parseInt(document.getElementById(id).value || "1",10)); }
  function clamp(id){
    const el = document.getElementById(id);
    if(!el.value || +el.value < 1) el.value = 1;
  }
  function step(id, delta){
    const el = document.getElementById(id);
    el.value = Math.max(1, (parseInt(el.value||"1",10) + delta));
    render();
  }

  function makeRow(n, target){
    target.innerHTML = "";
    for(let i=1;i<=n;i++){
      const d = document.createElement('div');
      d.className = 'chip'; d.textContent = i;
      d.dataset.v = i;
      target.appendChild(d);
    }
  }

  function paintDivisors(a,b){
    // リセット
    [...gridA.children, ...gridB.children].forEach(ch=>{
      ch.classList.remove('divA','divB','hit');
    });
    // 数１の約数（薄い黄色）
    for(let i=1;i<=a;i++){
      if(a % i === 0){
        const el = gridA.children[i-1];
        if(el) el.classList.add('divA');
      }
    }
    // 数２の約数（薄いピンク）
    for(let i=1;i<=b;i++){
      if(b % i === 0){
        const el = gridB.children[i-1];
        if(el) el.classList.add('divB');
      }
    }
  }

  function highlightCommon(a,b){
    // 既存のhitだけ外す（divA/divBは残す）
    [...gridA.children, ...gridB.children].forEach(ch => ch.classList.remove('hit'));

    const commons = [];
    const limit = Math.min(a,b);
    for(let i=1;i<=limit;i++){
      if(a % i === 0 && b % i === 0) commons.push(i);
    }
    for(const c of commons){
      const A = gridA.children[c-1];
      const B = gridB.children[c-1];
      if(A) A.classList.add('hit');
      if(B) B.classList.add('hit');
    }
    // 結果
    if(commons.length){
      listLine.classList.remove('empty');
      listLine.innerHTML = `<b>公約数：</b> ${commons.join('、')}`;
      gcdLine.classList.remove('empty');
      gcdLine.innerHTML = `<b>最大公約数：</b> ${commons[commons.length-1]}`;
    }else{
      listLine.classList.remove('empty');
      listLine.textContent = "公約数：なし";
      gcdLine.classList.remove('empty');
      gcdLine.textContent = "最大公約数：—";
    }
  }

  function render(){
    const a = val('a'), b = val('b');
    amax.textContent = a; bmax.textContent = b;
    makeRow(a, gridA);
    makeRow(b, gridB);
    paintDivisors(a,b);
    // 未判定文言へ
    listLine.classList.add('empty');
    gcdLine.classList.add('empty');
    listLine.textContent = "公約数がここに表示されます。";
    gcdLine.textContent = "最大公約数：—";
  }

  function findCommon(){ highlightCommon(val('a'), val('b')); }

  function resetAll(){
    document.getElementById('a').value = 12;
    document.getElementById('b').value = 18;
    render();
    window.scrollTo({top:0, behavior:'smooth'});
  }

  // 初期化
  render();
</script>
</body>
</html>
